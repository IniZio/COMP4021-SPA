<template> <div class="container rounded bg-white p-3" style="min-width:30rem"> <div class="row">  <div class="col form-group text-center mt-1"> <h2 style="font-weight:900">Registration</h2> </div> </div> <form id="regForm" @submit="submitRegister"> <div class="form-row"> <div class="col-md-6 col-sm-12 form-group" style="width:100%"> <label for="username">Username</label> <div class="input-group"> <div class="input-group-prepend"> <div class="input-group-text"><i class="fas fa-user"></i></div> </div> <input required class="form-control rounded-right" name="username" placeholder="Username" :value="form.username" @input="changeField"> <div :children="form.username"></div> <div id="unavailError" class="col-6 form-text text-center text-danger mt-2" style="display:none;font-size:.9rem"> <i class="fas fa-times mr-1"></i>The username is not available. </div> </div> </div> </div> <div class="form-row"> <div class="col-md-6 col-sm-12 form-group"> <label for="password">Password</label> <div class="input-group"> <div class="input-group-prepend"> <div class="input-group-text"><i class="fas fa-key"></i></div> </div> <input type="password" required class="form-control" name="password" placeholder="Password" :value="form.password" @input="changeField"> </div> <div style="color:red;height:1rem" :children="invalidPassword"></div> </div> <div class="col-md-6 col-sm-12 form-group"> <label for="confirmPassword">Confirm Password</label> <div class="input-group"> <div class="input-group-prepend"> <div class="input-group-text"><i class="fas fa-key"></i></div> </div> <input type="password" required class="form-control" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password" :value="form.confirmPassword" @input="changeField"> </div> </div> </div> <div class="form-row"> <div class="col-md-6 col-sm-12 form-group"> <label for="first_name">First name</label> <input required class="form-control" name="first_name" placeholder="First Name" :value="form.first_name" @input="changeField"> </div> <div class="col-md-6 col-sm-12 form-group"> <label for="last_name">Last name</label> <input required class="form-control" name="last_name" placeholder="Last Name" :value="form.last_name" @input="changeField"> </div> </div> <div style="height:4rem;margin:auto;width:304px"> <slot name="recaptcha"></slot> <div id="register-recaptcha" slot="recaptcha"></div> </div> <div class="col form-group text-center mt-4"> <button name="register" class="col-6 btn btn-primary"><i class="fas fa-clipboard-list mr-2"></i>Register</button> </div> <hr> <div class="form-text text-center mb-2"> Already has an account? </div> <div class="form-group text-center pb-2"> <router-link to="/login"><button type="button" class="col-5 btn btn-info"><i class="fas fa-sign-in-alt mr-2"></i>Login</button></router-link> </div> </form> </div> </template> <script>exportTag("register-form",class extends MyElement{data(){return{form:{username:"",password:"",confirmPassword:"",first_name:"",last_name:""},invalidPassword:""}}connectedCallback(){super.connectedCallback();this.observe(this.data,()=>{this.data.invalidPassword=this.data.form.password!==this.data.form.confirmPassword?"The passwords do not match":""}),this.captchaWidget=grecaptcha.render(document.getElementById("register-recaptcha"),{sitekey:"6LfUDFYUAAAAAMDbYCNjFpKP51yOXmGRcKDeRCzc"})}changeField(a){this.data.form[a.target.name]=a.target.value}async submitRegister(a){a.preventDefault(),a.target.classList.add("was-validated");grecaptcha.getResponse(this.captchaWidget);if(grecaptcha.reset(this.captchaWidget),!1!==a.target.checkValidity()){if(this.data.invalidPassword)return!1;try{const{data:{user:e}}=await api.register(this.data.form);this.context.profile=e}catch(a){switch(a.response&&a.response.status){case 400:swal("Error","User is already logged in","error");break;default:console.error(a),swal("Error","Register failed","error")}}console.log("submitting: ",JSON.stringify(this.data.form))}}},{nonShadow:!0});</script> 