<template>
  <slot></slot>
</template>

<script>
  exportTag('match-route', class extends MyElement {
    get path () {
      return this.getAttribute('path');
    }

    set path (val) {
      if (val) {
        this.setAttribute('path', '');
      } else {
        this.removeAttribute('path');
      }
    }

    constructor () {
      super()
      window.addEventListener('hashchange', this.visibilityOnHash.bind(this), false)
      this.visibilityOnHash({newURL: window.location.href}) 
    }

    visibilityOnHash ({newURL = '', oldURL = ''}) {
      const afterHash = newURL.split('#')[1] || ''
      if (this.path && !afterHash.startsWith(this.path)) {
        this._display = this.style.display      
        this.style.display = 'none'
      } else {
        if (this.style.display === 'none') {
          this.style.display = 'block'
        }
      }
    }

    disconnectedCallback () {
      super.disconnectedCallback()
    }
  })
</script>
