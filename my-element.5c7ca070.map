{"version":3,"sources":["primitives/my-element.js"],"names":["MyElement","arguments","_listeners","shadowRoot","attachShadow","mode","appendChild","template","content","cloneNode","applyListeners","clearListeners","instance","querySelectorAll","map","Array","from","node","attributes","filter","attr","name","startsWith","removeAttribute","value","Function","handler","bind","addEventListener","slice","push","el","event","removeEventListener","length","HTMLElement","window","exportTag","Class","prototype","document","currentScript","parentElement","querySelector","customElements","define"],"mappings":";;;;;;;;;;;;;;;IAAMA;;;AACJ,uBAAe;AAAA;;AAAA,uHACJC,SADI;;AAGb,UAAKC,UAAL,GAAkB,EAAlB;;AAEA,QAAI,CAAC,MAAKC,UAAV,EAAsB;AACpB;AACA,YAAKC,YAAL,CAAkB,EAACC,MAAM,MAAP,EAAlB;AACA;AACA,YAAKF,UAAL,CAAgBG,WAAhB,CAA4B,MAAKC,QAAL,CAAcC,OAAd,CAAsBC,SAAtB,CAAgC,IAAhC,CAA5B;AACD;AAVY;AAWd;;;;wCAEoB;AACnB,WAAKC,cAAL;AACD;;;2CAEuB;AACtB,WAAKC,cAAL;AACD;;;qCAEiB;AAAA;;AAChB,UAAMC,WAAW,IAAjB;;AAEA,WAAKT,UAAL,CAAgBU,gBAAhB,CAAiC,GAAjC,EACGC,GADH,CACO;AAAA,eACHC,MAAMC,IAAN,CAAWC,KAAKC,UAAhB;AACE;AADF,SAEGC,MAFH,CAEU;AAAA,iBAAQC,KAAKC,IAAL,CAAUC,UAAV,CAAqB,GAArB,CAAR;AAAA,SAFV,EAGGR,GAHH,CAGO,gBAAQ;AACX,iBAAKS,eAAL,CAAqBH,KAAKC,IAA1B;AACA,cAAIT,SAASQ,KAAKI,KAAd,aAAgCC,QAApC,EAA8C;AAC5C,gBAAMC,UAAUd,SAASQ,KAAKI,KAAd,EAAqBG,IAArB,CAA0Bf,QAA1B,CAAhB;AACA,mBAAKgB,gBAAL,CAAsBR,KAAKC,IAAL,CAAUQ,KAAV,CAAgB,CAAhB,CAAtB,EAA0CH,OAA1C;AACAd,qBAASV,UAAT,CAAoB4B,IAApB,CAAyB,EAACC,UAAD,EAAWC,OAAOZ,KAAKC,IAAL,CAAUQ,KAAV,CAAgB,CAAhB,CAAlB,EAAsCH,gBAAtC,EAAzB;AACD;AACF,SAVH,CADG;AAAA,OADP;AAcD;;;qCAEiB;AAChB,WAAKxB,UAAL,CAAgBY,GAAhB,CAAoB;AAAA,YAAEiB,EAAF,QAAEA,EAAF;AAAA,YAAMC,KAAN,QAAMA,KAAN;AAAA,YAAaN,OAAb,QAAaA,OAAb;AAAA,eAA0BK,GAAGE,mBAAH,CAAuBD,KAAvB,EAA8BN,OAA9B,CAA1B;AAAA,OAApB;AACA,WAAKxB,UAAL,CAAgBgC,MAAhB,GAAyB,CAAzB;AACD;;;;EA5CqBC;;AA+CxBC,OAAOpC,SAAP,GAAmBA,SAAnB;;AAEA;AACAoC,OAAOC,SAAP,GAAmB,YAAmD;AAAA,MAAlDhB,IAAkD,uEAA3C,EAA2C;AAAA,MAAvCiB,KAAuC;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA,IAAjBtC,SAAiB;;AACpEsC,QAAM/B,QAAN,GAAiB+B,MAAMC,SAAN,CAAgBhC,QAAhB,GAA2BiC,SAASC,aAAT,CAAuBC,aAAvB,CAAqCC,aAArC,CAAmD,UAAnD,CAA5C;AACA,SAAOP,OAAOQ,cAAP,CAAsBC,MAAtB,CAA6BxB,IAA7B,EAAmCiB,KAAnC,CAAP;AACD,CAHD;;kBAKetC","file":"my-element.5c7ca070.map","sourceRoot":"../client","sourcesContent":["class MyElement extends HTMLElement {\n  constructor () {\n    super(...arguments)\n\n    this._listeners = []\n\n    if (!this.shadowRoot) {\n      // Attach shadow DOM\n      this.attachShadow({mode: 'open'})\n      // Append template content to custom element\n      this.shadowRoot.appendChild(this.template.content.cloneNode(true))\n    }\n  }\n\n  connectedCallback () {\n    this.applyListeners()\n  }\n\n  disconnectedCallback () {\n    this.clearListeners()\n  }\n\n  applyListeners () {\n    const instance = this\n\n    this.shadowRoot.querySelectorAll('*')\n      .map(node =>\n        Array.from(node.attributes)\n          // e.g. @click\n          .filter(attr => attr.name.startsWith('@'))\n          .map(attr => {\n            this.removeAttribute(attr.name)\n            if (instance[attr.value] instanceof Function) {\n              const handler = instance[attr.value].bind(instance)\n              this.addEventListener(attr.name.slice(1), handler)\n              instance._listeners.push({el: this, event: attr.name.slice(1), handler})\n            }\n          })\n      )\n  }\n\n  clearListeners () {\n    this._listeners.map(({el, event, handler}) => el.removeEventListener(event, handler))\n    this._listeners.length = 0\n  }\n}\n\nwindow.MyElement = MyElement\n\n// Define custom element\nwindow.exportTag = (name = '', Class = class extends MyElement {}) => {\n  Class.template = Class.prototype.template = document.currentScript.parentElement.querySelector('template')\n  return window.customElements.define(name, Class)\n}\n\nexport default MyElement\n"]}